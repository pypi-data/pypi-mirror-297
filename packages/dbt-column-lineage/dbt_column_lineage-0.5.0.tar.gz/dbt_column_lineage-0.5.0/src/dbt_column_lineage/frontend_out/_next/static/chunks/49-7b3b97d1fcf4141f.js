"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49],{37215:function(e,t,a){a.d(t,{h:function(){return j}});var s=a(57437),o=a(16463),n=a(2265),r=a(67397),l=a(44390),i=a(44839),c=a(6920),u=a(1970);let d=e=>(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsxs)("div",{className:"text-gray-500",children:[(0,s.jsx)(c.G,{icon:u.cC_,className:"h-[12px] mr-1"}),(0,s.jsx)("span",{children:e.label})]}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.options.length})})]}),m=e=>{let{value:t,label:a,description:o}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:a}),(0,s.jsx)("div",{className:"text-gray-500",children:o})]})},h={control:{base:"flex border rounded-md bg-input hover:cursor-pointer min-w-[100px] !min-h-[36px] w-[100%] h-[100%] text-foreground text-foreground",focus:"",nonFocus:"border-border"},option:{base:"hover:cursor-pointer px-3 py-2 rounded flex gap-2 items-center hover:bg-muted !text-sm",focus:"bg-[rgba(var(--primary),0.1)]",selected:"bg-[rgba(var(--primary),0.3)] hover:bg-[rgba(var(--primary),0.3)] text-primary font-bold"}},p={control:e=>{let{isFocused:t}=e;return(0,i.W)(t?h.control.focus:h.control.nonFocus,h.control.base)},option:e=>{let{isSelected:t,isFocused:a}=e;return(0,i.W)(h.option.base,t?h.option.selected:"",a?h.option.focus:"")},menu:()=>"p-1 mt-1 bg-white rounded-md shadow-md",placeholder:()=>"text-placeholder pl-1",input:()=>"text-foreground pl-1",valueContainer:()=>"p-1 gap-1",singleValue:()=>"pl-1",multiValue:()=>"flex bg-[rgba(var(--primary),0.15)] p-0 pl-2 rounded-sm text-xs overflow-hidden",multiValueLabel:()=>"py-1",multiValueRemove:()=>"bg-[rgba(var(--primary),0.1)] hover:bg-[rgba(var(--primary),0.2)] text-primary px-1 ml-2",indicatorsContainer:()=>"p-1 gap-1",clearIndicator:()=>"text-muted-foreground px-1 hover:text-error",indicatorSeparator:()=>"bg-border",dropdownIndicator:()=>"p-1 hover:bg-muted text-muted-foreground rounded-md hover:text-foreground",groupHeading:()=>"ml-3 mt-2 mb-1 text-muted-foreground text-sm",noOptionsMessage:()=>"text-placeholder py-3"},x=e=>{let{options:t,className:a,isMulti:o=!1,value:c,onChange:u,useFormatOptionLabel:h=!1}=e;return(0,s.jsx)(r.ZP,{instanceId:(0,n.useId)(),unstyled:!0,options:t,isMulti:o,value:c,onChange:u,classNames:{...p},className:(0,i.W)(a),formatGroupLabel:d,formatOptionLabel:h?m:void 0,components:{Input:e=>(0,s.jsx)(l.c.Input,{...e,"aria-activedescendant":void 0})}})};var g=a(90497);let b=e=>{let{schemas:t,sources:a,selectedSources:o,columns:r,schema:l,activeSource:c,selectedColumns:u,onSchemaChange:d,onSourcesChange:m,onActiveSourceChange:h,onColumnsChange:p,isMulti:b,className:v}=e,[f,w]=(0,n.useState)(!1),j=(0,n.useRef)(null);return(0,n.useEffect)(()=>{function e(e){j.current&&!j.current.contains(e.target)&&w(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[j]),(0,s.jsxs)("div",{ref:j,className:(0,i.W)("relative inline-block text-left",v),children:[(0,s.jsx)("div",{children:(0,s.jsxs)("button",{type:"button",className:(0,i.W)("inline-flex justify-between w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-indigo-500",v),onClick:()=>w(!f),children:[(0,s.jsxs)("span",{children:[l," | ",c," | ",u.join(", ")]}),(0,s.jsx)(g.Z,{className:"ml-2 -mr-1 h-5 w-5","aria-hidden":"true"})]})}),f&&(0,s.jsx)("div",{className:"origin-top-left absolute left-0 mt-2 w-[900px] rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4",role:"menu","aria-orientation":"horizontal","aria-labelledby":"options-menu",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Schema"}),(0,s.jsx)(x,{options:t,value:{label:l,value:l},onChange:e=>d(e.value),className:"mb-4"}),(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Sources"}),(0,s.jsx)(x,{options:a,value:o.map(e=>({label:e,value:e})),onChange:(e,t)=>{if(console.log(e,t),b){let a=e.map(e=>e.value);m(a),"select-option"===t.action?h(t.option.value):h(a[0])}else m([e.value]),h(e.value)},className:"mb-2",isMulti:b,useFormatOptionLabel:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Active Source"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:o.map(e=>(0,s.jsx)("button",{className:(0,i.W)("px-3 py-1 rounded-md text-sm font-medium",e===c?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),onClick:()=>h(e),children:e},e))}),(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Columns"}),r[c]&&(0,s.jsx)(x,{options:r[c],value:u.map(e=>({label:e,value:e})),onChange:e=>{b?p(e.map(e=>e.value)):p([e.value])},className:"mb-2",isMulti:b,useFormatOptionLabel:!0})]})]})})]})};var v=a(45079),f=a(71165),w=a(20357);let j=e=>{let{handleFetchData:t}=e,[a,r]=(0,n.useState)("/cl"),[l,i]=(0,n.useState)([]),[u,d]=(0,n.useState)([]),[m,h]=(0,n.useState)({}),[p,x]=(0,n.useState)(!0),[g,j]=(0,n.useState)("obt"),[y,C]=(0,n.useState)(["obt_sales_order"]),[N,S]=(0,n.useState)("obt_sales_order"),[L,_]=(0,n.useState)(["week_ver"]),[k,E]=(0,n.useState)({obt_sales_order:["week_ver"]}),M=(0,f.o)(e=>e.loading),P=(0,f.o)(e=>e.setLoading),I=(0,f.o)(e=>e.showColumn),A=(0,f.o)(e=>e.setShowColumn),O=(0,f.o)(e=>e.setColumnModeEdges),R=(0,o.useRouter)(),T=(0,o.usePathname)(),U=(0,o.useSearchParams)(),W=(0,n.useCallback)(async()=>{let e=w.env.NEXT_PUBLIC_API_HOSTNAME||"",t=await fetch("".concat(e,"/api/v1/schemas")),a=await t.json();return i(a),a},[]),D=(0,n.useCallback)(async e=>{let t=new URLSearchParams({schema:e}),a=w.env.NEXT_PUBLIC_API_HOSTNAME||"",s=await fetch("".concat(a,"/api/v1/sources?").concat(t)),o=await s.json();return d(o),o},[g]),z=(0,n.useCallback)(async e=>{let t=new URLSearchParams({source:e}),a=w.env.NEXT_PUBLIC_API_HOSTNAME||"",s=await fetch("".concat(a,"/api/v1/columns?").concat(t)),o=await s.json();return h(t=>({...t,[e]:o})),o},[g]),H=(0,n.useCallback)(async e=>{j(e),await D(e)},[]),F=(0,n.useCallback)(async e=>{C(e)},[]),V=(0,n.useCallback)(async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];S(e),m[e]||await z(e),t&&_(k[e]||[])},[g,m,k]),B=(0,n.useCallback)(e=>{_(e),E(t=>({...t,[N]:e}))},[N]),G=(0,n.useCallback)(async function(){let e,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a){var s;let t=U.get("schema"),a=(null===(s=U.get("sources"))||void 0===s?void 0:s.split(","))||[],o=U.get("activeSource"),n=JSON.parse(U.get("selectedColumns"))||{},r="true"===U.get("showColumn");W(),H(t),F(a),V(o,!1),r&&A(r),E(n),_(n[o]||[]),e={schema:t,sources:a,columns:n,showColumn:r}}else e={schema:g,sources:y,columns:k,showColumn:I};P(!0);let o=await t(e);if(P(!1),O([]),!a&&o){let e=new URLSearchParams({schema:g,sources:y.join(","),activeSource:N,selectedColumns:JSON.stringify(k),showColumn:I.toString()});R.push("".concat(T,"?").concat(e))}},[T,g,y,N,I,k]),X=(0,n.useCallback)(()=>"/cl"===a,[a]);return(0,n.useEffect)(()=>{U.size?G(!0):(W(),D(g),z(N)),T!==a&&r(T)},[]),(0,n.useEffect)(()=>{if(g&&y.length>0){for(let e of y)if(X()&&(!k[e]||0===k[e].length)){x(!0);return}x(!1)}else x(!0)},[g,y,N,k]),(0,s.jsx)("header",{className:"bg-white border-b-[1px]",children:(0,s.jsxs)("nav",{className:"container mr-auto flex flex-wrap flex-col md:flex-row items-center",children:[(0,s.jsx)("a",{className:"flex title-font font-medium items-center text-gray-900 mb-4 md:mb-0",children:(0,s.jsx)("span",{className:"ml-3 text-xl",children:(0,s.jsxs)("select",{value:a,onChange:e=>R.push(e.target.value),children:[(0,s.jsx)("option",{value:"/cte",children:"CTE Lineage"}),(0,s.jsx)("option",{value:"/cl",children:"Column Level Lineage"})]})})}),(0,s.jsxs)("nav",{className:"md:mr-auto md:ml-4 md:py-2 md:pl-4 md:border-l md:border-gray-400 flex flex-wrap items-center text-base justify-center",children:[(0,s.jsx)(b,{schemas:l,sources:u,selectedSources:y,columns:m,schema:g,activeSource:N,selectedColumns:L,onSchemaChange:e=>H(e),onSourcesChange:e=>F(e),onActiveSourceChange:e=>V(e),onColumnsChange:B,className:"mr-2 w-[60vw]",isMulti:X()}),(0,s.jsx)("button",{type:"button",className:"border-[1px] border-blue-400 px-3 py-1.5 bg-blue-400 text-s text-white font-semibold rounded hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>G(),disabled:p,children:M?(0,s.jsx)(c.G,{icon:v.LM3,spinPulse:!0}):(0,s.jsx)("span",{children:"Submit"})})]})]})})}},27289:function(e,t,a){a.d(t,{Y:function(){return o}});var s=a(2265);let o=()=>{let[e,t]=(0,s.useState)({width:0,height:100});return(0,s.useEffect)(()=>{{let e=()=>{t({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}},[]),e}},71165:function(e,t,a){a.d(t,{o:function(){return s}});let s=(0,a(13e3).Ue)()(e=>({options:{rankdir:"LR"},showColumn:!0,sidebarActive:!1,loading:!1,clearNodePosition:!1,columnModeEdges:[],leftMaxDepth:!1,rightMaxDepth:!1,setOptions:t=>e({options:t}),setShowColumn:t=>e({showColumn:t}),setSidebarActive:t=>e({sidebarActive:t}),setLoading:t=>e({loading:t}),setClearNodePosition:t=>e({clearNodePosition:t}),setColumnModeEdges:t=>e({columnModeEdges:t}),setLeftMaxDepth:t=>e({leftMaxDepth:t}),setRightMaxDepth:t=>e({rightMaxDepth:t})}))}}]);