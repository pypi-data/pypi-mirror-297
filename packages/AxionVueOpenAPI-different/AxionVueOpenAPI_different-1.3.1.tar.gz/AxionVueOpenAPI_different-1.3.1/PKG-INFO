Metadata-Version: 2.1
Name: AxionVueOpenAPI_different
Version: 1.3.1
Summary: This is a python wrapper for the Axion Vue windows app to use it headless
Home-page: https://github.com/vildande/AxionVueOpenAPI_different
Author: Tom Nijhof
Keywords: AxionVueOpenAPI_different
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Science/Research
Classifier: Operating System :: Microsoft
Classifier: Natural Language :: English
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3 :: Only 
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics 
Classifier: Topic :: Scientific/Engineering :: Medical Science Apps.
Description-Content-Type: text/markdown
License-File: LICENSE

[![Downloads](https://pepy.tech/badge/AxionVueOpenAPI)](https://pepy.tech/project/AxionVueOpenAPI)
[![Downloads](https://pepy.tech/badge/CytoSmartOpenAPI)](https://pepy.tech/project/CytoSmartOpenAPI)
[![Downloads](https://pepy.tech/badge/luxconnector)](https://pepy.tech/project/luxconnector)

# Axion Vue Open API

This is a Python wrapper for the Axion Vue Windows app to use it headless.
The package will only work on Windows 10 and above.

This package was formally known as `luxconnector` or `CytoSmartOpenAPI`

## Warranty

> ⚠️ **Hardware warranty is void by using this open API** ⚠️:
>
> Using the AxionVueOpenAPI means you will have NO hardware warranty (see license).

This is because our devices are made to handle the normal usage ([the GUI app](https://download.axionbio.com/)).
It also includes additionally bought warranty.
Only if your additionally bought warranty implicitly includes the Open API usage you will have warranty.

## Installation

To install this package follow these steps:

### Step 1: Drivers

Make sure you had a [Axion Vue application installed](http://download.axionbio.com/).

Recommended is the cell counter given it does not restart itself after closing.
This is needed to have all the correct drivers installed.
Uninstall the app afterwards.
If the app is on the same machine the Open API might connect with the wrong one.

### Step 2: pip install

```cmd
pip install AxionVueOpenAPI
```

## Initialization

Make sure at least one Axion imaging device is physically connected to your computer via a USB3 port.
The AxionVueOpenAPI is an object that maintains the connection with the device.
To create the object use the following code:

```python
from AxionVueOpenAPI import AxionVueOpenAPI
connector = AxionVueOpenAPI(number_of_devices=2, warranty=False)
```

> ⚠️ You are voiding your warranty by using this package

NOTE: Make sure number_of_devices does not exceed the number of devices you have physically connected.
Otherwise the AxionVueOpenAPI will look for the missing devices forever.

## Getting serial numbers

Each physical device has a serial number.
This number is needed to send commands to a specific device.

```python
serial_numbers = connector.get_all_serial_numbers()
```

## Getting a single image

When you want a single image taken at this moment use get_image.
This will return the image as a [`pillow image`](https://pillow.readthedocs.io/en/stable/reference/Image.html).
You need to give the serial number of the device you want to target.

```python
img = connector.get_image(serial_number)
```

or

```python
img = connector.get_image(serial_numbers[index])
```

## Changing the focus

This function will change the focus for the AxionVueOpenAPI object.
Every image taken after this function will have the new focus.

The focus is in the range 0 until 1. (0.0 and 1.0 are valid entries)

You need to give the serial number of the device you want to target.

```python
connector.set_focus(serial_number, 0.5)
img1 = connector.get_image(serial_number) # Image with focus of 0.5
connector.set_focus(serial_number, 0.7)
img2 = connector.get_image(serial_number) # Image with focus of 0.7
img3 = connector.get_image(serial_number) # Image with focus of 0.7
```

## Auto focus

The device goes over multiple possible focuses to find the best focus.
It will use image analysis to determine how well the image is in focus.

```python
# Fast but goes over a limited range to cover most manufactured cell counting slides
connector.do_autofocus(serial_number, "slide")
# Fastest: goes over the limited range where cells can be in focus on the Axion Exact slide
connector.do_autofocus(serial_number, "CSslide")
# Slow, but goes over the full range of possible focusses: suitable for any vessel that works with the Axion imaging device
connector.do_autofocus(serial_number, "other")
```

## Getting the temperature

This function returns the temperature in Celsius of the device.

You need to give the serial number of the device you want to target.

```python
temperature = connector.get_temperature(serial_number)
```

## Change active camera (fluorescence)

To use fluorescence you will need to change the active camera.
The camera can be set to 3 different values, RED, GREEN, or BRIGHTFIELD.
This will only work if your device is an FL device otherwise only BRIGHTFIELD is available.

```python
connector.set_active_camera(serial_number, "RED")
connector.set_active_camera(serial_number, "GREEN")
connector.set_active_camera(serial_number, "BRIGHTFIELD")
```

## Change camera setting

Each camera has its own settings.
Not all settings are available for BRIGHTFIELD.

- exposure: The time in milliseconds that the camera is detecting light. (Lux and Exact devices only; for Omni devices use flash duration)
- gain: The multiplication of the camera. (Fluo only)
  If very little light goes into the camera sensor make sure the gain is high.
- brightness: Strength of the led when it is on. (Fluo only)
- focus_offset: The difference in focus between brightfield and fluo.
  If focus is set to 0.4 and focus_offset for RED is set to 0.1 RED focus is 0.5 (Fluo only)

```python
connector.set_camera_settings(serial_number, "RED", 500, gain=30, brightness=5000, focus_offset=0.0)
connector.set_camera_settings(serial_number, "BRIGHTFIELD", 10)
```

## Change flash duration (Omni only)

The Omni cannot change the exposure time but can change the time the led is on.
This can be done with set_flash_duration.
It will set the duration between 40 and 250 μs.

```python
connector.set_flash_duration(serial_number, duration=120)
```

If you do NOT have an Omni use set_camera_settings.

## Getting a z-stack

This function will return a list of [`pillow images`](https://pillow.readthedocs.io/en/stable/reference/Image.html).
Each image will be at a different focus level.

This code will create a z-stack of 6 images.
The focuses of these images will be [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]

You need to give the serial number of the device you want to target.

```python
list_of_imgs = connector.get_z_stack(serial_number, num_img = 6, start_focus = 0.5, stop_focus = 1)
```

## Change stage (Omni only)

To change the position of the Omni stage (camera, led, arm, ect.) give the new position in mm.

- Position x in mm
- Position y in mm
- Time in seconds it can wait till it arrives (default 60)

```python
connector.move_stage(serial_number, 100, 100, 60)
```

After this the normal process for obtaining and changing cameras applies.

## Get stage position (Omni only)

If you need to know where the stage is, use get_position.
This also works if the Omni moved without a move_stage command (e.g. when it goes to sleep).

```python
print(connector.get_position(serial_number))
```

## Changing zoom modes (Lux only)

There are 2 zoom modes: "IN" and "OUT".
While zoomed in the resolution is higher but the ROI is smaller, zoomed out has a higher ROI but a lower resolution.
Since zooming in comprises digital zoom, the image will not show more sample details.

Changing this setting will change it for every image or z-stack taken afterwards.

You need to give the serial number of the device you want to target.

```python
connector.set_zoom(serial_number, "IN")
img1 = connector.get_image(serial_number) # Image is zoomed in
connector.set_zoom(serial_number, "OUT")
img2 = connector.get_image(serial_number) # Image is zoomed out
```

## Live view

The live view of the device is hosted at http://localhost:3333/cytosmartservice/live?serialNumber=##########.
This image can only been seen if the live view is turned on (by default the live view is turned on).

You need to give the serial number of the device you want to target at the place of the #-symbols.

```python
connector.set_liveview(serial_number, False) # Led of device turns off till you take a picture
connector.set_liveview(serial_number, True) # In the browser you can see the image being updated
connector.open_liveview(serial_number) # Opens liveview in the default browser
```

## Developers

Developers of the AxionVueOpenAPI please look at the [`developers readme`](README_DEV.md)

## Credits

- Tom "RoadRunner" Nijhof
- Nora
- Tessa
- Marc "it is with a c" van Vijven
- Julia "I did not break it, I tested it" van den Beemd
- Count Nicolai Vondracek, Señior sunshine manager


History
-------
1.3.1 (2023-03-29)
------------------
- Renaming to AxionVueOpenAPI

1.3.0 (2022-08-25)
------------------
- Add open_liveview
- Add do_autofocus
- Add listener to autofocus change
- Bugfix: set_focus. Make sure camera_setting is completed before setting the focus

1.2.0 (2022-06-27)
------------------
- Update server to support Omni
- Add move stage
- Add get position
- Add set flash duration
- Add mandatory turning off of warranty
- Check for connection loss and reconnect is closed
- Check for sleeping device

1.1.1 (2022-06-29)
------------------
- Update documentation

1.1.0 (2021-12-03)
------------------
- Add change camera settings
- Add set activate camera (brightfield, red-fluo, or green-fluo)
- Change focus: 
    make sure focus always happens in brightfield camera mode
    Add sleep after changing to focus so camera can move to new position
- Update to new Cytosmart app

1.0.4 (2021-04-15)
------------------
- Update Pillow
- Fix installation requirements

1.0.3 (2021-11-22)
------------------
- Update requirements of websocket and websocket-client to include version 1
- Check if app is open before starting a new one

1.0.2 (2021-04-15)
------------------
- Update pillow
- Update license to ACADEMIC PUBLIC LICENSE

1.0.1 (2021-01-14)
------------------
- Added support for LUX3 FL
- Bugfix: toggle liveview when change zoom level

1.0.0 (2020-09-15)
------------------
- Added multi lux support
- Changed output from numpy array to pillow
- Require serial number with function to get information
- Add get_temperature

0.1.2 (2020-06-30)
------------------
- Rename failing to pinging in print statement

0.1.1 (2020-06-11)
------------------
- Update documentation
- Make setup.py fit for PyPI
 
0.1.0 (2020-05-20)
------------------
- Update lux server to latest version

0.0.3 (2020-03-30)
------------------
- bugfix: files were not copied into package on linux

0.0.2 (2020-03-24)
------------------
- Bugfix: stop waiting for response after sending a message

0.0.1 (2020-03-16)
------------------

- Add function: Copy the luxconnector 
- Add function: focus change option
- Add function: z-stack
- Bugfix: add lux app to manifest

0.0.0 (2020-03-13)
------------------

Copied basic package a start of luxconnector


                         ACADEMIC PUBLIC LICENSE
                                version 1.1

                           Copyright (C) 2021


                                Preamble

This license contains the terms and conditions of using AxionVueOpenAPI in
noncommercial settings: at academic institutions for teaching and research
use and for personal or educational purposes. You will find that this
license provides noncommercial users of AxionVueOpenAPI with rights that are
similar to the well-known GNU General Public License, yet it retains the
possibility for AxionVueOpenAPI authors to financially support the development by
selling commercial licenses. In fact, if you intend to use AxionVueOpenAPI in a
"for-profit" environment, where research is conducted to develop or enhance
a product, is used in a commercial service offering, or when an entity uses
AxionVueOpenAPI to participate in government-funded, EU-funded, military or similar
research projects, then you need to obtain a commercial license.
In that case, or if you are unsure, please contact the Author imaging.support@axionbio.com
to inquire about commercial licenses.

What are the rights given to noncommercial users? Similarly to GPL, you
have the right to use the software, to distribute copies, to receive source
code, to change the software and distribute your modifications or the
modified software. Also similarly to the GPL, if you distribute verbatim or
modified copies of this software, they must be distributed under this
license.

By modeling the GPL, this license guarantees that you're safe when using
AxionVueOpenAPI in your work, for teaching or research. This license guarantees
that AxionVueOpenAPI will remain available free of charge for nonprofit use. You
can modify AxionVueOpenAPI to your purposes, and you can also share your modifications.
Even in the unlikely case of the authors abandoning AxionVueOpenAPI entirely, this
license permits anyone to continue developing it from the last release, and
to create further releases under this license.

We believe that the combination of noncommercial open-source and commercial
licensing will be beneficial for the whole user community, because income from
commercial licenses will enable faster development and a higher level of
software quality, while further enjoying the informal, open communication
and collaboration channels of open source development.

The precise terms and conditions for using, copying, distribution and
modification follow.

                         ACADEMIC PUBLIC LICENSE

    TERMS AND CONDITIONS FOR USE, COPYING, DISTRIBUTION AND MODIFICATION

0. Definitions

"Program" means a copy of AxionVueOpenAPI, which is said to be distributed under
this Academic Public License.

"Work based on the Program" means either the Program or any derivative work
under copyright law: that is to say, a work containing the Program or a
portion of it, either verbatim or with modifications and/or translated into
another language. (Hereinafter, translation is included without limitation
in the term "modification".)

"Using the Program" means any act of creating executables that contain or
directly use libraries that are part of the Program, running any of the
tools that are part of the Program, or creating works based on the Program.

Each licensee is addressed as "you".

1. Permission is hereby granted to use the Program free of charge for
   noncommercial purposes, including teaching and academic research at
   universities, colleges and other educational institutions and personal
   non-profit purposes. For using the Program for commercial purposes,
   including but not restricted to consulting activities, design of commercial
   hardware or software networking products, and joint research with a
   commercial entity, government-funded, EU-funded, military or similar
   research projects, you have to contact the Author at imaging.support@axionbio.com
   for an appropriate license. Permission is also granted to use the Program
   for a reasonably limited period of time for the purpose of evaluating its
   usefulness for a particular purpose.

2. You may copy and distribute verbatim copies of the Program's
   source code as you receive it, in any medium, provided that you
   conspicuously and appropriately publish on each copy an appropriate
   copyright notice and disclaimer of warranty; keep intact all the
   notices that refer to this License and to the absence of any warranty;
   and give any other recipients of the Program a copy of this License
   along with the Program.
   The program is provided on an "as-is" basis. The maintainers of the program
   make no warranties regarding the information provided,
   and disclaims liability for damages resulting from its use.
   Using the program voids the warranty given by the manufacturer of the device.

3. You may modify your copy or copies of the Program or any portion
   of it, thus forming a work based on the Program, and copy and
   distribute such modifications or work under the terms of Section 2
   above, provided that you also meet all of these conditions:


    a) You must cause the modified files to carry prominent notices
    stating that you changed the files and the date of any change.

    b) You must cause any work that you distribute or publish, that in
    whole or in part contains or is derived from the Program or any
    part thereof, to be licensed as a whole at no charge to all third
    parties under the terms of this License.

These requirements apply to the modified work as a whole. If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works. But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose regulations for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.
(If the same, independent sections are distributed as part of a package
that is otherwise reliant on, or is based on the Program, then the
distribution of the whole package, including but not restricted to the
independent section, must be on the unmodified terms of this License,
regadless of who the author of the included sections was.)

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based or reliant on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
storage or distribution medium does not bring the other work under
the scope of this License.

4. You may copy and distribute the Program (or a work based on it,
   under Section 3) in object code or executable form under the terms of
   Sections 2 and 3 above provided that you also do one of the following:


    a) Accompany it with the complete corresponding machine-readable
    source code, which must be distributed under the terms of Sections
    2 and 3 above on a medium customarily used for software interchange; or,

    b) Accompany it with a written offer, valid for at least three
    years, to give any third party, for a charge no more than your
    cost of physically performing source distribution, a complete
    machine-readable copy of the corresponding source code, to be
    distributed under the terms of Sections 2 and 3 above on a medium
    customarily used for software interchange; or,

    c) Accompany it with the information you received as to the offer
    to distribute corresponding source code.  (This alternative is
    allowed only for noncommercial distribution and only if you received
    the program in object code or executable form with such an offer,
    in accord with Subsection b) above.)

The source code for a work means the preferred form of the work for
making modifications to it. For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable. However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

5. You may not copy, modify, sublicense, or distribute the Program
   except as expressly provided under this License. Any attempt
   otherwise to copy, modify, sublicense or distribute the Program is
   void, and will automatically terminate your rights under this License.
   However, parties who have received copies, or rights, from you under
   this License will not have their licenses terminated so long as such
   parties remain in full compliance.

6. You are not required to accept this License, since you have not
   signed it. Nothing else grants you permission to modify or distribute
   the Program or its derivative works; law prohibits these actions
   if you do not accept this License. Therefore, by modifying or distributing
   the Program (or any work based on the Program), you indicate your
   acceptance of this License and all its terms and conditions for copying,
   distributing or modifying the Program or works based on it, to do so.

7. Each time you redistribute the Program (or any work based on the
   Program), the recipient automatically receives a license from the
   original licensor to copy, distribute or modify the Program subject to
   these terms and conditions. You may not impose any further
   restrictions on the recipients' exercise of the rights granted herein.
   You are not responsible for enforcing compliance by third parties to
   this License.

8. If, as a consequence of a court judgment or allegation of patent
   infringement or for any other reason (not limited to patent issues),
   conditions are imposed on you (whether by court order, agreement or
   otherwise) that contradict the conditions of this License, they do not
   excuse you from the conditions of this License. If you cannot
   distribute so as to satisfy simultaneously your obligations under this
   License and any other pertinent obligations, then as a consequence you
   may not distribute the Program at all. For example, if a patent
   license would not permit royalty-free redistribution of the Program by
   all those who receive copies directly or indirectly through you, then
   the only way you could satisfy both it and this License would be to
   refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

9.  If the distribution and/or use of the Program are restricted in
    certain countries either by patents or by copyrighted interfaces, the
    original copyright holder who places the Program under this License
    may add an explicit geographical distribution limitation excluding
    those countries, so that distribution is permitted only in or among
    countries not thus excluded. In such case, this License incorporates
    the limitation as if written in the body of this License.

                                NO WARRANTY

10. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
    FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN
    OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
    PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
    OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS
    TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE
    PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
    REPAIR OR CORRECTION.

11. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED ON IN WRITING
    WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
    REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
    INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
    OUT OF THE USE OR INABILITY TO USE THE PROGRAM INCLUDING BUT NOT LIMITED
    TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
    YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
    PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGES.

                         END OF TERMS AND CONDITIONS

Initially written by Andras Varga (public domain) for OMNeT++ https://omnetpp.org/intro/license,
adapted by CytoSMART TECHNOLOGIES BV. The adaptation is licensed under CC0 1.0 (Public Domain Dedication).
