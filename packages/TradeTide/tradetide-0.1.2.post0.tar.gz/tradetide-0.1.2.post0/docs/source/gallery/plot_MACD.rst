
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/plot_MACD.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_plot_MACD.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_plot_MACD.py:


Moving Average Crossing indicator
=================================

.. GENERATED FROM PYTHON SOURCE LINES 7-8

Import necessary modules and classes from the TradeTide package

.. GENERATED FROM PYTHON SOURCE LINES 8-11

.. code-block:: python3

    from TradeTide import BackTester, indicators, get_market_data
    from TradeTide import capital_management, risk_management








.. GENERATED FROM PYTHON SOURCE LINES 12-13

Load historical market data for EUR/USD pair for the year 2023 and limit to 4000 data points

.. GENERATED FROM PYTHON SOURCE LINES 13-15

.. code-block:: python3

    market_data = get_market_data('eur', 'usd', year=2023, time_span='3day', spread=0)








.. GENERATED FROM PYTHON SOURCE LINES 16-17

Initialize a Moving Average Crossing indicator with specific window settings and minimum period

.. GENERATED FROM PYTHON SOURCE LINES 17-23

.. code-block:: python3

    indicator = indicators.MACD(
        short_period=12,
        long_period=26,
        signal_period=9
    )








.. GENERATED FROM PYTHON SOURCE LINES 24-25

Generate trading signals based on the market data

.. GENERATED FROM PYTHON SOURCE LINES 25-27

.. code-block:: python3

    indicator.generate_signal(market_data)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    0       0
    1       1
    2       1
    3       1
    4       1
           ..
    1430   -1
    1431   -1
    1432   -1
    1433   -1
    1434   -1
    Name: signal, Length: 1435, dtype: int64



.. GENERATED FROM PYTHON SOURCE LINES 28-29

Plot the indicator signals overlaid on the market data

.. GENERATED FROM PYTHON SOURCE LINES 29-31

.. code-block:: python3

    indicator.plot()




.. image-sg:: /gallery/images/sphx_glr_plot_MACD_001.png
   :alt: plot MACD
   :srcset: /gallery/images/sphx_glr_plot_MACD_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 32-33

Create the BackTester instance, linking it with the market data and chosen strategy

.. GENERATED FROM PYTHON SOURCE LINES 33-35

.. code-block:: python3

    backtester = BackTester(market=market_data, strategy=indicator)








.. GENERATED FROM PYTHON SOURCE LINES 36-37

Set up loss and profit management with specified stop loss and take profit percentages

.. GENERATED FROM PYTHON SOURCE LINES 37-43

.. code-block:: python3

    risk = risk_management.DirectLossProfit(
        market=market_data,
        stop_loss='10pip',
        take_profit='10pip',
    )








.. GENERATED FROM PYTHON SOURCE LINES 44-45

Configure capital management strategy with initial capital, spread, and trading constraints

.. GENERATED FROM PYTHON SOURCE LINES 45-56

.. code-block:: python3

    capital_management = capital_management.LimitedCapital(
        initial_capital=100_000,
        risk_management=risk,
        max_cap_per_trade=10_000,
        limit_of_positions=1,
        micro_lot=1_000
    )

    # Execute the backtest using the configured capital management strategy
    backtester.backtest(capital_management=capital_management)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>date</th>
          <th>units</th>
          <th>holdings</th>
          <th>short_positions</th>
          <th>long_positions</th>
          <th>cash</th>
          <th>total</th>
          <th>returns</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>2023-08-04 08:13:00+00:00</td>
          <td>0.0</td>
          <td>0.00000</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>100000.00000</td>
          <td>100000.00000</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>1</th>
          <td>2023-08-04 08:14:00+00:00</td>
          <td>0.0</td>
          <td>0.00000</td>
          <td>0.0</td>
          <td>0.0</td>
          <td>100000.00000</td>
          <td>100000.00000</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>2</th>
          <td>2023-08-04 08:15:00+00:00</td>
          <td>9132.0</td>
          <td>9998.53548</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90000.73396</td>
          <td>99999.26944</td>
          <td>-0.000007</td>
        </tr>
        <tr>
          <th>3</th>
          <td>2023-08-04 08:16:00+00:00</td>
          <td>9132.0</td>
          <td>9998.71812</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90000.73396</td>
          <td>99999.45208</td>
          <td>0.000002</td>
        </tr>
        <tr>
          <th>4</th>
          <td>2023-08-04 08:17:00+00:00</td>
          <td>9132.0</td>
          <td>9998.99208</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90000.73396</td>
          <td>99999.72604</td>
          <td>0.000003</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>1430</th>
          <td>2023-08-07 08:08:00+00:00</td>
          <td>9102.0</td>
          <td>9999.63924</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90009.55278</td>
          <td>100009.19202</td>
          <td>0.000004</td>
        </tr>
        <tr>
          <th>1431</th>
          <td>2023-08-07 08:09:00+00:00</td>
          <td>9102.0</td>
          <td>10000.82250</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90009.55278</td>
          <td>100010.37528</td>
          <td>0.000012</td>
        </tr>
        <tr>
          <th>1432</th>
          <td>2023-08-07 08:10:00+00:00</td>
          <td>9102.0</td>
          <td>10000.82250</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90009.55278</td>
          <td>100010.37528</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>1433</th>
          <td>2023-08-07 08:11:00+00:00</td>
          <td>9102.0</td>
          <td>9999.91230</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90009.55278</td>
          <td>100009.46508</td>
          <td>-0.000009</td>
        </tr>
        <tr>
          <th>1434</th>
          <td>2023-08-07 08:12:00+00:00</td>
          <td>9102.0</td>
          <td>9999.00210</td>
          <td>0.0</td>
          <td>1.0</td>
          <td>90009.55278</td>
          <td>100008.55488</td>
          <td>-0.000009</td>
        </tr>
      </tbody>
    </table>
    <p>1435 rows Ã— 8 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 57-58

Visualize the backtest results, showing the strategy's performance against the market price

.. GENERATED FROM PYTHON SOURCE LINES 58-60

.. code-block:: python3

    backtester.plot(show_price=True)




.. image-sg:: /gallery/images/sphx_glr_plot_MACD_002.png
   :alt: Trading Strategy Overview
   :srcset: /gallery/images/sphx_glr_plot_MACD_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 61-62

Calculate and display key performance metrics for the trading strategy

.. GENERATED FROM PYTHON SOURCE LINES 62-64

.. code-block:: python3

    metrics = backtester.metrics








.. GENERATED FROM PYTHON SOURCE LINES 65-66

Retrieve and print the final total value of the portfolio after completing the backtest

.. GENERATED FROM PYTHON SOURCE LINES 66-67

.. code-block:: python3

    metrics.print()




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Property              value
    --------------------  -------------------------
    Start Date            2023-08-04 08:13:00+00:00
    Stop Date             2023-08-07 08:12:00+00:00
    Duration              2 days 23:59:00
    Reward-Risk ratio     1.0
    Returns               0.01%
    Returns [annualized]  3.17%
    Maximum drawdown      -0.06%
    Sharpe Ratio          0.06
    Sortino Ratio         121.67
    Number of Trades      22
    Win-Loss Ratio        1.00
    Equity                $100,008.55
    Volatility            0.03%





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.449 seconds)


.. _sphx_glr_download_gallery_plot_MACD.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_MACD.py <plot_MACD.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_MACD.ipynb <plot_MACD.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
