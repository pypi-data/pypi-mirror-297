import nltk
import re

nltk.download('punkt')

emoji_dict = {
    "ЁЯШК": "рж╣рж╛рж╕рж┐",
    "ЁЯШв": "ржХрж╛ржирзНржирж╛",
    "ЁЯШа": "рж░рж╛ржЧ",
    "ЁЯШФ": "ржоржи ржЦрж╛рж░рж╛ржк",
    "ЁЯСН": "ржжрж╛рж░рзБржг",
    "ЁЯШО": "ржарж╛ржирзНржбрж╛",
    "ЁЯШн": "ржЕрж╢рзНрж░рзБ",
    "ЁЯШБ": "ржорзБржЪржХрж┐ рж╣рж╛рж╕рж┐",
    "ЁЯШЕ": "рж╣рж╛рж▓ржХрж╛ рж╣рж╛рж╕рж┐",
    "ЁЯШН": "ржнрж╛рж▓ржмрж╛рж╕рж╛",
    "ЁЯШТ": "ржЕрж╕ржирзНрждрзБрж╖рзНржЯ",
    "ЁЯШЮ": "рж╣рждрж╛рж╢рж╛",
    "ЁЯШб": "рж░рж╛ржЧрж╛ржирзНржмрж┐ржд",
    "ЁЯШГ": "ржЦрзБрж╢рж┐",
    "ЁЯШЙ": "ржЪрзЛржЦ ржорж╛рж░рж╛",
    "ЁЯШЛ": "рж╕рзНржмрж╛ржж ржЖрж╕рзНржмрж╛ржжржи",
    "ЁЯШР": "ржирж┐рж░рзНржмрж┐ржХрж╛рж░",
    "ЁЯШд": "ржЕрж╕ржирзНрждрзБрж╖рзНржЯ",
    "ЁЯШ┤": "ржШрзБржо",
    "ЁЯШЬ": "ржоржЬрж╛рж░",
    "ЁЯШй": "ржХрзНрж▓рж╛ржирзНржд",
    "ЁЯШп": "ржЖрж╢рзНржЪрж░рзНржп",
    "ЁЯШЖ": "рж╣рж╛рж╕рж┐",
    "ЁЯШ╖": "ржорж╛рж╕рзНржХ",
    "ЁЯЩД": "ржЧрзБрж░рзНржЧрзБрж░рж╛ржирж┐",
    "ЁЯШ│": "ржмрж┐рж╕рзНржорж┐ржд",
    "ЁЯШм": "ржЪрж┐ржирзНрждрж┐ржд",
    "ЁЯШЪ": "ржЪрзБржорзНржмржи",
    "ЁЯШ░": "ржЙржжрзНржмрж┐ржЧрзНржи",
    "ЁЯдЧ": "ржЖрж▓рж┐ржЩрзНржЧржи",
    "ЁЯдФ": "ржЪрж┐ржирзНрждрж╛рж╢рзАрж▓",
    "ЁЯдР": "ржорзБржЦ ржмржирзНржз",
    "ЁЯШЗ": "ржкрзБржгрзНржпржмрж╛ржи"
}

bn_stopwords =['ржЬрж╛ржирж╛ржпрж╝', 'ржУржЦрж╛ржирзЗ', 'рждрж╛рж░рж╛', 'рж╕ржЩрзНржЧрзЗ', 'ржзрж░рж╛', 'ржЫрж╛ржбрж╝рж╛', 'ржХрж░рзЗ', 'ржЖржжрзНржпржнрж╛ржЧрзЗ', 'ржУрж░рж╛', 'рж╣ржУржпрж╝рж╛ржпрж╝', 'ржХрж░рж╛ржпрж╝', 'ржПрждржЯрж╛ржЗ', 'рж╕ржм', 'ржПржХржЯрж┐', 'ржХрж░рзЗржи', 'ржПржоржирж┐', 'ржХрж░рзЗржЫрзЗ', 'ржПржЗ', 'ржмрзЗрж╢', 'ржУржБржжрзЗрж░', 'ржмрж▓рж▓', 'ржХрзНрж╖рзЗрждрзНрж░рзЗ', 'ржХрж┐ржВржмрж╛', 'ржжрж┐ржпрж╝рзЗржЫрзЗ', 'рж╢рзБржзрзБ', 'ржПрж▓', 'ржПржоржи', 'ржЖржкржирж╛рж░рж╛', 'ржпрж╛рж░', 'ржЯрж┐', 'ржХрж░ржмрзЗ', 'ржЗ', 'ржЪрж╛рж░', 'ржирзЗржУрзЯрж╛', 'ржЖржЗ', 'ржмрж▓рзЗ', 'ржкрж░рзНржпржирзНржд', 'рж▓ржХрзНрж╖', 'рж╕ржмрж╛ржЗ', 'ржХрж┐ржнрж╛ржмрзЗ', 'рждрж╛рж╣рж╛рждрзЗ', 'ржмрзНржпржмрж╣рж╛рж░', 'рж╕ржХрж▓', 'рж╕рж░рзНржмржирж┐ржорзНржи', 'рждрж╛ржУ', 'ржкрзЗржпрж╝рзЗ', 'ржирж╛ржирж╛', 'ржУржжрзЗрж░', 'ржЕрж░рзНржерж╛ржд', 'ржХрж░рзЗржЫрзЗржи', 'рж╣ржЪрзНржЫрзЗ', 'рж╕рзЗржЗ', 'ржПржЯрж┐', 'рж╣ржмрзЗржи', 'ржЧрзЗрж▓', 'ржХрзЗржЙржЗ', 'ржПржмрж╛рж░', 'ржЕржмрж╢рзНржпржЗ', 'ржнрзЗрждрж░рзЗ', 'ржЖржЧрзЗржЗ', 'рж╕ржмрж╛рж░', 'ржЕржкрж░', 'ржХрж░рзЗржЫрж┐рж▓рзЗржи', 'рж╕рзБрждрж░рж╛ржВ', 'ржЕржирзНрждржд', 'ржорж╛ржЭрзЗ', 'рждржмрзБ', 'рждрж╛ржБрж╛рж╣рж╛рж░рж╛', 'ржкрж╛рж░рж┐', 'ржЕржирзНржп', 'рж╣рзЛржХ', 'ржкрзНрж░рждрж┐', 'ржПржЯрж╛ржЗ', 'ржПрж░рж╛', 'ржпрж╛ржБрж░', 'ржмрж┐ржнрж┐ржирзНржи', 'рж╣ржд', 'ржУржБрж░', 'ржпржЦржи', 'ржУрж░', 'ржжрзБржЗ', 'рж╣рж▓рзЗ', 'ржоржзрзНржпржмрж░рзНрждрзА', 'ржЕржирзНржпрж╛ржирзНржп', 'рждржд', 'ржЖржмрж╛рж░', 'ржХрж┐ржирзНрждрзБ', 'ржоржзрзНржпрзЗржЗ', 'рж╣ржпрж╝рзЗ', 'ржирждрзБржи', 'ржмрж░ржВ', 'ржЖржорж╛ржжрзЗрж░', 'ржерж╛ржХрж╛ржпрж╝', 'рж╣ржЗржпрж╝рж╛', 'ржжрзБржЯрж┐', 'ржПржБржжрзЗрж░', 'рж╕рж╛ржоржирзЗ', 'ржарж┐ржХ', 'ржжрж┐рж▓рзЗржи', 'ржирзЯ', 'ржХрж╛ржЫ', 'ржПржд', 'ржХрж░ржЫрзЗ', 'ржХржмрзЗ', 'ржЧрзБрж▓рж┐', 'ржЧрж┐ржпрж╝рзЗ', 'ржЬржи', 'ржжрж┐ржпрж╝рзЗ', 'ржЕржержмрж╛', 'ржЕржирзЗржХрзЗржЗ', 'ржПржЦржи', 'ржжрзЗржЦрждрзЗ', 'ржпрж╛ржУрзЯрж╛', 'ржирж┐рждрзЗ', 'ржЬржиржХрзЗ', 'ржЖржорж░рж╛', 'ржХрж░рж┐рждрзЗ', 'ржмрж╣рзБ', 'ржерзЗржХрзЗржУ', 'ржХрж░рж▓рзЗ', 'ржЧрж┐ржпрж╝рзЗржЫрзЗ', 'ржХржо', 'рж╕рзЗржЯрж╛ржУ', 'ржЖржЧрж╛ржорзА', 'рж╢рзБрж░рзБ', 'ржЧрж┐рзЯрзЗ', 'ржХрзЛржи', 'ржЧрзЛржЯрж╛', 'ржХрж┐', 'ржХрзАржнрж╛ржмрзЗ', 'ржХрж░рж┐', 'ржжрзЗржУржпрж╝рж╛', 'рждрж╛ржБржжрзЗрж░', 'рж╕рзНржкрж╖рзНржЯ', 'ржПрж░ржкрж░', 'ржерж╛ржХрж╛', 'ржпрж╛ржУржпрж╝рж╛', 'ржирзЗржУржпрж╝рж╛рж░', 'ржпрж╛ржи', 'ржпрж╛ржХрзЗ', 'ржХрж░рж╛ржЗ', 'рждрж╛рж╣рж╛', 'рж╕ржЩрзНржЧрзЗржУ', 'ржмрж▓рж▓рзЗржи', 'ржжрзЗржЦрзЗ', 'ржмрзНржпрж╛ржкрж╛рж░рзЗ', 'ржжрзЗржЦрж╛', 'ржЬржирзНржп', 'ржпрзЗрждрзЗ', 'ржХрж░рж┐ржпрж╝рзЗ', 'ржпрж╛рждрзЗ', 'ржерж╛ржХрзЗ', 'рждрж╛ржБрж░рж╛', 'рждрж╛рж╣рж╛рж░', 'ржПржЫрж╛ржбрж╝рж╛', 'ржПрж╕рзЗ', 'рж╣ржпрж╝', 'ржпрж╛ржЪрзНржЫрзЗ', 'ржпрждржЯрж╛', 'ржерж╛ржХрзЗржи', 'ржХрж╛ржЫрзЗ', 'рж╕ржорзНржкрзНрж░рждрж┐', 'рж╣рж▓рзЗржУ', 'рждрж┐ржи', 'ржЪрж▓рзЗ', 'ржкрзНрж░рж╛ржержорж┐ржХ', 'ржоржирзЗ', 'рж╣рзИрж▓рзЗ', 'рж░ржпрж╝рзЗржЫрзЗ', 'ржкрзНрж░рж╛ржпрж╝', 'ржПржЯрж╛', 'ржорждрзЛ', 'рж╣рж▓рзЗржЗ', 'ржерзЗржХрзЗржЗ', 'рждрж╛ржБрж░', 'ржЗрж╣рж╛', 'ржЕржмрж╢рзНржп', 'рждрзБрж▓рзЗ', 'рж╣ржпрж╝ржирж┐', 'ржпрж╛ржжрзЗрж░', 'ржУржБрж░рж╛', 'ржЕржирзЗржХрзЗ', 'ржХрзА', 'рждрж┐ржирж┐', 'ржЬрж╛ржирж╛ржирзЛ', 'ржЪрж╛ржпрж╝', 'ржлрж┐рж░рзЗ', 'ржПржХрзЗ', 'рждржерж╛', 'ржнрж╛ржмрзЗ', 'ржжрзЗржУржпрж╝рж╛рж░', 'ржлрзЗрж░', 'ржУржХрзЗ', 'ржХрж░рж╛рж░', 'ржХрзЗржи', 'рж░', 'ржкрж╛рж░рзЗржи', 'ржмрж▓рзЗржи', 'рждрж┐ржирж┐ржУ', 'ржХрж╛рж░ржг', 'ржкрж┐', 'ржЕрждржПржм', 'рж╕рзЗржЦрж╛ржирзЗ', 'рждрж╛рж░ржкрж░', 'рждрж╛рждрзЗ', 'ржХржд', 'ржорзЛржЯ', 'ржПрж╕', 'рждрзБржорж┐', 'ржпрзЗржЦрж╛ржирзЗ', 'ржжрж┐ржи', 'ржЪрзЗрж╖рзНржЯрж╛', 'ржЦрзБржм', 'рж░рж╛ржЦрж╛', 'ржЙржирж┐', 'ржЫрж╛ржбрж╝рж╛ржУ', 'ржжрзЗржи', 'рж╣рждрзЗ', 'рж╣рждрзЗржЗ', 'рж╕рж╣', 'ржмрж▓рждрзЗ', 'ржирж┐ржЬрзЗ', 'ржПржХржЗ', 'рждрж╛', 'рж╣ржпрж╝рзЗржЫрзЗржи', 'рждржмрзЗ', 'ржЬрж╛ржирж╛', 'рж╣ржпрж╝рзЗржЫрж┐рж▓', 'ржЬржирзЗрж░', 'ржЪрзЗржпрж╝рзЗ', 'ржиржпрж╝', 'ржирж╛рж╣рж▓рзЗ', 'ржЕржержЪ', 'рждрж╛ржБржХрзЗ', 'ржмржи', 'ржЖржорж┐', 'рждрж╛ржжрзЗрж░', 'ржпржжрж┐ржУ', 'рж╣ржУржпрж╝рж╛рж░', 'ржХрж╛рж░ржУ', 'ржХрзЗ', 'ржПржХржмрж╛рж░', 'рждрзЛржорж╛рж░', 'ржЙржЪрж┐ржд', 'ржЖрж░', 'ржорж╛ржзрзНржпржорзЗ', 'ржмржжрж▓рзЗ', 'рж╕рж╛ржзрж╛рж░ржг', 'рж╣рж▓рзЛ', 'ржирж╛ржХрж┐', 'рж╕ржорж╕рзНржд', 'ржпрж╛рж░рж╛', 'ржЖржЬ', 'рж░ржХржо', 'ржмрж╛ржжрзЗ', 'ржирж┐рж╢рзНржЪрж┐ржд', 'ржЗрждрзНржпрж╛ржжрж┐', 'ржерзЗржХрзЗ', 'ржЖрж╕рж╛', 'ржЖрж░ржУ', 'ржпрж╛ржмрзЗ', 'рж╕рзЗржЦрж╛ржи', 'ржерж╛ржХржмрзЗржи', 'ржХрж░ржЫрзЗржи', 'ржоржзрзНржпрзЗ', 'ржЙрждрзНрждрж░', 'ржкрж╛ржЪ', 'ржХржЦржиржУ', 'рж╕рзНржмржпрж╝ржВ', 'рж╣ржмрзЗ', 'ржкрзБрж░рж╛ржирзЛ', 'ржпржерзЗрж╖рзНржЯ', 'рждрж╛ржХрзЗ', 'ржПрждрзЗ', 'ржХрж╛ржЙржХрзЗ', 'ржирзЗржУржпрж╝рж╛', 'ржХржпрж╝рзЗржХ', 'ржоржзрзНржпрзЗржУ', 'ржПржЦржиржУ', 'ржЧрзЗржЫрзЗ', 'ржХрж░рзЗржЗ', 'ржпрж╛', 'ржЖржЧрзЗ', 'рж╣рж╛ржЬрж╛рж░', 'ржорзЛржЯрзЗржЗ', 'ржХрж┐ржЫрзБржЗ', 'ржжрж┐рждрзЗ', 'ржЬрж╛ржирж┐ржпрж╝рзЗржЫрзЗ', 'ржкрж░рзЗржЗ', 'ржХрзЗржиржирж╛', 'ржпрзЗржоржи', 'ржПржмржВ', 'рждржЦржи', 'рж╕рзЗржЯрж╛ржЗ', 'ржлрж▓рзЗ', 'ржпржд', 'ржЙрж▓рзНрж▓рзЗржЦржпрзЛржЧрзНржп', 'рж╣ржпрж╝рзЗржЗ', 'ржЙржкрж░', 'ржЕржирзЗржХ', 'ржкрзНрж░ржержо', 'ржирж┐рж░рзНржмрж╛ржЪржи', 'ржЬрж╛ржирждрзЗ', 'рж░рзЗржЦрзЗ', 'ржкрж╛ржУржпрж╝рж╛', 'ржХрзЗржЙ', 'ржкрзНрж░рждрж┐ржЯрж┐', 'ржЖржЫрзЗ', 'рждрж╛ржЗ', 'ржжрзЗржУрзЯрж╛', 'ржирж┐ржЬрзЗржЗ', 'ржУ', 'ржЖржкржирж┐', 'рждрж╛рж╣рж▓рзЗ', 'ржоржзрзНржпржнрж╛ржЧрзЗ', 'рж╕рж┐', 'ржкрж░', 'рж╕рзЗ', 'ржПржХрзН', 'ржЬрзЗ', 'ржирж╛', 'ржХрж░рждрзЗ', 'ржЕржмржзрж┐', 'ржУржЗ', 'ржкрзНрж░ржпржирзНржд', 'ржПржЦрж╛ржирзЗ', 'ржЬрж╛ржирж┐ржпрж╝рзЗ', 'ржХрж╛ржЬ', 'ржмрж┐', 'ржкрж░рзЗрж░', 'ржкржХрзНрж╖рзЗ', 'ржПржЦрж╛ржирзЗржЗ', 'ржмрзЗрж╢рж┐', 'рж╕рзЗржЯрж┐', 'ржмрж╕рзЗ', 'ржжрзЗржпрж╝', 'ржирзЗржЗ', 'ржПржХ', 'ржпрзЗржи', 'рж╣ржи', 'ржпрзЗ', 'рждрзЗржоржи', 'ржжрж┐ржпрж╝рзЗржЫрзЗржи', 'ржорждрзЛржЗ', 'ржирж┐ржЬрзЗрж░', 'ржжрзБржЯрзЛ', 'ржЧрзЗрж▓рзЗ', 'ржПржБрж░рж╛', 'рж╣ржпрж╝рждрзЛ', 'ржмржХрзНрждржмрзНржп', 'рж╣рж┐рж╕рж╛ржмрзЗ', 'ржкрж╛рж░рзЗ', 'рждрж┐ржиржР', 'ржпрж┐ржирж┐', 'ржзрж░рзЗ', 'ржЕржирзБржпрж╛ржпрж╝рзА', 'ржХрж┐ржЫрзБ', 'ржерж╛ржХржмрзЗ', 'ржЫрж┐рж▓', 'рждрзЛ', 'ржЖржорж╛ржХрзЗ', 'ржХржоржирзЗ', 'ржПржм', 'ржирж╛ржЧрж╛ржж', 'ржП', 'ржмрж┐рж╢рзЗрж╖', 'ржжрж┐ржХрзЗ', 'ржпржжрж┐', 'рж╕рзЗржЯрж╛', 'ржирж╛ржЗ', 'ржирж┐ржЬрзЗржжрзЗрж░', 'ржЫрж┐рж▓рзЗржи', 'рж╣рзЯ', 'ржкрж░рзЗржУ', 'ржкрж░рзЗ', 'рж╣рж▓', 'ржмрж┐ржирж╛', 'ржжрзБ', 'ржЖржкржирж╛рж░', 'ржХрж░рж▓рзЗржи', 'ржХрж░рж╛', 'ржХрзЯрзЗржХ', 'ржХрзЗржЦрж╛', 'ржЙржкрж░рзЗ', 'ржирж┐ржпрж╝рзЗ', 'ржжрзНржмрж╛рж░рж╛', 'ржорж╛рждрзНрж░', 'ржнрж╛ржмрзЗржЗ', 'рж╣ржЗржмрзЗ', 'ржХрзЛржирзЛ', 'ржЬржирзНржпржУржЬрзЗ', 'ржХрзЛржЯрж┐', 'рж╣ржЗрждрзЗ', 'ржХрж╛рж░ржгрзЗ', 'рж╕рж░рзНржмрзЛржЪрзНржЪ', 'ржПрж░', 'ржХрж░рж┐ржпрж╝рж╛', 'ржР', 'ржЬрзНржиржЬржи', 'ржмрж╛', 'рж╕рж╣рж┐ржд', 'ржкрзНрж░рж╛рзЯ', 'ржмрж╛рж░', 'ржЪрж╛ржи', 'ржмрж┐рж╖ржпрж╝ржЯрж┐', 'ржпрж╛ржБрж░рж╛', 'ржмрж▓рзЗржЫрзЗржи', 'ржкрзНрж░ржнрзГрждрж┐', 'ржЖржорж╛рж░', 'ржХрж░ржмрзЗржи', 'ржЕржзрж┐ржХ', 'рж╣ржУржпрж╝рж╛', 'ржзрж╛ржорж╛рж░', 'рждрж╛рж░', 'ржПржоржиржХрзА', 'ржХрж╛ржЬрзЗ', 'ржпрж╛ржУржпрж╝рж╛рж░', 'ржмрж▓рж╛', 'ржХржпрж╝рзЗржХржЯрж┐', 'рждрж╛рж░рзИ', 'ржпрж╛ржпрж╝', 'ржХрзЛржиржУ', 'ржирж┐рзЯрзЗ', 'рж╣ржпрж╝рзЗржЫрзЗ', 'ржкрзЗрзЯрзНрж░рзН', 'ржПржжрзЗрж░', 'ржЪрж╛рж▓рзБ']
def remove_stopwords(text):
    words = nltk.word_tokenize(text)
    filtered_words = [word for word in words if word not in bn_stopwords]
    return ' '.join(filtered_words)

def remove_non_bangla_words(text):
    return ' '.join([word for word in text.split() if all('ржА' <= c <= 'рз┐' for c in word)])

def remove_null_characters(text):
    return text.replace('\x00', '')

def remove_urls(text):
    url_pattern = re.compile(r'https?://\S+|www\.\S+')
    return url_pattern.sub(r'', text)

def replace_emojis(text):
    for emoji, meaning in emoji_dict.items():
        text = text.replace(emoji, meaning)
    return text

def remove_bangla_digits(text):
    bangla_digit_pattern = r'[рзж-рзп]'
    text = re.sub(bangla_digit_pattern, '', text)
    return text

def preprocess_text(text):
    text = replace_emojis(text)
    text = remove_stopwords(text)
    text = remove_non_bangla_words(text)
    text = remove_null_characters(text)
    text = remove_urls(text)
    text = remove_bangla_digits(text)
    return text
