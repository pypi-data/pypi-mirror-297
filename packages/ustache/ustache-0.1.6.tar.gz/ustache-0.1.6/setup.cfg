[flake8]
doctests = true
benchmark = true
rst-roles = 
	attr
	class
	meth
	func
	py:func
	mod
rst-directives = 
	versionadded
	versionchanged
	deprecated
	todo
ignore = 
	E123
	E402
	W503
	SIM105

[yapf]
indent_closing_brackets = true
join_multiple_lines = false

[mypy]
ignore_missing_imports = True

[coverage:run]
source = ustache
branch = true
parallel = true

[coverage:report]
fail_under = 100

[tox:tox]
minversion = 3.18.0
envlist = codestyle,py,coverage,docs

[testenv]
extras = tests
description = run test suite and generate coverage metrics
commands = 
	coverage run -m unittest tests.py

[testenv:benchmark]
extras = benchmark
description = run benchmark suite
commands = 
	python -m reference.benchmark

[testenv:codestyle]
extras = codestyle
description = check coding style (pep8, pep257, static checking)
commands = 
	flake8 ustache.py setup.py docs/conf.py
	mypy ustache.py

[testenv:coverage]
extras = coverage
description = collect, process and report test coverage
commands = 
	coverage combine
	coverage html --fail-under=0
	coverage report

[testenv:docs]
extras = docs
description = generate module documentation
changedir = {toxinidir}/docs
commands = 
	sphinx-build -ab coverage . undoc
	sphinx-build -ab html . build

[testenv:release]
extras = release
description = upload release to (test)pypi
setenv = TWINE_REPOSITORY = {env:TWINE_REPOSITORY:testpypi}
allowlist_externals = 
	rm
	mkdir
commands = 
	rm -Rf dist
	mkdir dist
	python setup.py sdist bdist_wheel
	twine upload dist/*

[egg_info]
tag_build = 
tag_date = 0

